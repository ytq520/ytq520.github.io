<!DOCTYPE HTML>
<html>

<head><meta name="generator" content="Hexo 3.8.0">
	<link rel="bookmark" type="image/x-icon" href="/img/logo_miccall.png">
	<link rel="shortcut icon" href="/img/logo_miccall.png">
	
			    <title>
    ytq520
    </title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <link rel="stylesheet" href="/css/mic_main.css">
    <link rel="stylesheet" href="/css/dropdownMenu.css">
    <meta name="keywords" content="miccall">
    
    	<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	 
    <noscript>
        <link rel="stylesheet" href="/css/noscript.css">
    </noscript>
    <style type="text/css">
        body:before {
          content: ' ';
          position: fixed;
          top: 0;
          background: url('/img/bg.jpg') center 0 no-repeat;
          right: 0;
          bottom: 0;
          left: 0;
          background-size: cover; 
        }
    </style>

			    
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script async type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.scrollex.min.js"></script>
    <script src="/js/jquery.scrolly.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>
    <script src="/js/main.js"></script>
	
</head>
    
		
<!-- Layouts -->



<!--  代码渲染  -->
<link rel="stylesheet" href="/css/prism_coy.css">
<link rel="stylesheet" href="/css/typo.css">
<!-- 文章页 -->
<body class="is-loading">
    <!-- Wrapper 外包 s-->
    <div id="wrapper" class="fade-in">
        <!-- Intro 头部显示 s -->
        <!-- Intro 头部显示 e -->
        <!-- Header 头部logo start -->
        <header id="header">
    <a href="/" class="logo">ytq520</a>
</header>
        <!-- Nav 导航条 start -->
        <nav id="nav" class="special">
            <ul class="menu links">
			<!-- Homepage  主页  --> 
			<li>
	            <a href="/" rel="nofollow">主页</a>
	        </li>
			<!-- categories_name  分类   --> 
	        
	        <li class="active">
	            <a href="#s1">分类</a>
	                    <ul class="submenu">
	                        <li>
	                        <a class="category-link" href="/categories/Data-Analysis/">Data Analysis</a></li><li><a class="category-link" href="/categories/Django/">Django</a></li><li><a class="category-link" href="/categories/Flask/">Flask</a></li><li><a class="category-link" href="/categories/JavaScript/">JavaScript</a></li><li><a class="category-link" href="/categories/MySQL/">MySQL</a></li><li><a class="category-link" href="/categories/html/">html</a></li><li><a class="category-link" href="/categories/python基础/">python基础</a>
	                    </li></ul>
	        </li>
	        
	        <!-- archives  归档   --> 
	        
	        
		        <!-- Pages 自定义   -->
		        
		        <li>
		            <a href="/gallery/" title="图库">
		                图库
		            </a>
		        </li>
		        
		        <li>
		            <a href="/tag/" title="标签">
		                标签
		            </a>
		        </li>
		        


            </ul>
            <!-- icons 图标   -->
			<ul class="icons">
                    
                    <li>
                        <a title="github" href="https://github.com/ytq520" target="_blank" rel="noopener">
                            <i class="icon fa fa-github"></i>
                        </a>
                    </li>
                    
                    <li>
                        <a title="500px" href="http://500px.com" target="_blank" rel="noopener">
                            <i class="icon fa fa-500px"></i>
                        </a>
                    </li>
                    
			</ul>
</nav>

        <div id="main">
            <div class="post_page_title_img" style="height: 25rem;background-image: url(/images/thumbs/07.jpg);background-position: center; background-repeat:no-repeat; background-size:cover;-moz-background-size:cover;overflow:hidden;">
                <a href="#" style="padding: 4rem 4rem 2rem 4rem ;"><h2>熟悉Pandas</h2></a>
            </div>
            <!-- Post -->
            <div class="typo" style="padding: 3rem;">
                <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br></pre></td><td class="code"><pre><span class="line">pandas是专⻔为处理表格和混杂数据设计的，⽽NumPy更适合处理统⼀</span><br><span class="line">的数值数组数据。</span><br><span class="line">In [1]: import pandas as pd</span><br><span class="line">pandas的数据结构介绍</span><br><span class="line">两个主要数据结构：Series和DataFrame</span><br><span class="line">Series</span><br><span class="line">Series是⼀种类似于⼀维数组的对象，它由⼀组数据（各种NumPy数据类型）以及⼀组与之相</span><br><span class="line">关的数据标签（即索引）组成</span><br><span class="line">In [11]: obj = pd.Series([4, 7, -5, 3])</span><br><span class="line">In [12]: obj</span><br><span class="line">Out[12]:</span><br><span class="line">0 4</span><br><span class="line">1 7</span><br><span class="line">2 -5</span><br><span class="line">3 3</span><br><span class="line">dtype: int64</span><br><span class="line">In [13]: obj.values</span><br><span class="line">Out[13]: array([ 4, 7, -5, 3])</span><br><span class="line">In [14]: obj.index /# like range(4)/</span><br><span class="line">Out[14]: RangeIndex(start=0, stop=4, step=1)</span><br><span class="line">创建Series带有⼀个可以对各个数据点进⾏标记的索引</span><br><span class="line">In [15]: obj2 = pd.Series([4, 7, -5, 3], index=[&apos;d&apos;, &apos;b&apos;, &apos;a&apos;, &apos;c&apos;])</span><br><span class="line">In [16]: obj2</span><br><span class="line">Out[16]:</span><br><span class="line">d 4</span><br><span class="line">b 7</span><br><span class="line">a -5</span><br><span class="line">c 3</span><br><span class="line">dtype: int64</span><br><span class="line">In [17]: obj2.index</span><br><span class="line">Out[17]: Index([&apos;d&apos;, &apos;b&apos;, &apos;a&apos;, &apos;c&apos;], dtype=&apos;object&apos;)</span><br><span class="line">通过索引的⽅式选取Series中的单个或⼀组值</span><br><span class="line">In [18]: obj2[&apos;a&apos;]</span><br><span class="line">Out[18]: -5</span><br><span class="line">In [19]: obj2[&apos;d&apos;] = 6</span><br><span class="line">In [20]: obj2[[&apos;c&apos;, &apos;a&apos;, &apos;d&apos;]]</span><br><span class="line">Out[20]:</span><br><span class="line">c 3</span><br><span class="line">a -5</span><br><span class="line">d 6</span><br><span class="line">dtype: int64</span><br><span class="line">In [21]: obj2[obj2 &gt; 0]</span><br><span class="line">Out[21]:</span><br><span class="line">d 6</span><br><span class="line">b 7</span><br><span class="line">c 3</span><br><span class="line">dtype: int64</span><br><span class="line">In [22]: obj2 * 2</span><br><span class="line">Out[22]:</span><br><span class="line">d 12</span><br><span class="line">b 14</span><br><span class="line">a -10</span><br><span class="line">c 6</span><br><span class="line">dtype: int64</span><br><span class="line">Series看成是⼀个定⻓的有序字典</span><br><span class="line">In [24]: &apos;b&apos; in obj2</span><br><span class="line">Out[24]: True</span><br><span class="line">In [25]: &apos;e&apos; in obj2</span><br><span class="line">Out[25]: False</span><br><span class="line">直接通过这个字典来创建Series</span><br><span class="line">In [26]: sdata = &#123;&apos;Ohio&apos;: 35000, &apos;Texas&apos;: 71000, &apos;Oregon&apos;: 16000, &apos;Utah&apos;: 5000&#125;</span><br><span class="line">In [27]: obj3 = pd.Series(sdata)</span><br><span class="line">In [28]: obj3</span><br><span class="line">Out[28]:</span><br><span class="line">Ohio 35000</span><br><span class="line">Oregon 16000</span><br><span class="line">Texas 71000</span><br><span class="line">Utah 5000</span><br><span class="line">dtype: int64</span><br><span class="line">传⼊排好序的字典的键以改变顺序</span><br><span class="line">In [29]: states = [&apos;California&apos;, &apos;Ohio&apos;, &apos;Oregon&apos;, &apos;Texas&apos;]</span><br><span class="line">In [30]: obj4 = pd.Series(sdata, index=states)</span><br><span class="line">In [31]: obj4</span><br><span class="line">Out[31]:</span><br><span class="line">California NaN</span><br><span class="line">Ohio 35000.0</span><br><span class="line">Oregon 16000.0</span><br><span class="line">Texas 71000.0</span><br><span class="line">dtype: float64</span><br><span class="line">NaN（即“⾮数字”（not a number），在pandas中，它⽤于表示缺失或NA值）</span><br><span class="line">pandas的isnull和notnull函数可⽤于检测缺失数据</span><br><span class="line">In [32]: pd.isnull(obj4)</span><br><span class="line">Out[32]:</span><br><span class="line">California True</span><br><span class="line">Ohio False</span><br><span class="line">Oregon False</span><br><span class="line">Texas False</span><br><span class="line">dtype: bool</span><br><span class="line">In [33]: pd.notnull(obj4)</span><br><span class="line">Out[33]:</span><br><span class="line">California False</span><br><span class="line">Ohio True</span><br><span class="line">Oregon True</span><br><span class="line">Texas True</span><br><span class="line">dtype: bool</span><br><span class="line">Series最重要的⼀个功能是，它会根据运算的索引标签⾃动对⻬数据</span><br><span class="line">In [35]: obj3</span><br><span class="line">Out[35]:</span><br><span class="line">Ohio 35000</span><br><span class="line">Oregon 16000</span><br><span class="line">Texas 71000</span><br><span class="line">Utah 5000</span><br><span class="line">dtype: int64</span><br><span class="line">In [36]: obj4</span><br><span class="line">Out[36]:</span><br><span class="line">California NaN</span><br><span class="line">Ohio 35000.0</span><br><span class="line">Oregon 16000.0</span><br><span class="line">Texas 71000.0</span><br><span class="line">dtype: float64</span><br><span class="line">In [37]: obj3 + obj4</span><br><span class="line">Out[37]:</span><br><span class="line">California NaN</span><br><span class="line">Ohio 70000.0</span><br><span class="line">Oregon 32000.0</span><br><span class="line">Texas 142000.0</span><br><span class="line">Utah NaN</span><br><span class="line">dtype: float64</span><br><span class="line">Series对象本身及其索引都有⼀个name属性</span><br><span class="line">In [38]: obj4.name = &apos;population&apos;</span><br><span class="line">In [39]: obj4.index.name = &apos;state&apos;</span><br><span class="line">In [40]: obj4</span><br><span class="line">Out[40]:</span><br><span class="line">state</span><br><span class="line">California NaN</span><br><span class="line">Ohio 35000.0</span><br><span class="line">Oregon 16000.0</span><br><span class="line">Texas 71000.0</span><br><span class="line">Name: population, dtype: float64</span><br><span class="line">Series的索引可以通过赋值的⽅式就地修改</span><br><span class="line">In [41]: obj</span><br><span class="line">Out[41]:</span><br><span class="line">0 4</span><br><span class="line">1 7</span><br><span class="line">2 -5</span><br><span class="line">3 3</span><br><span class="line">dtype: int64</span><br><span class="line">In [42]: obj.index = [&apos;Bob&apos;, &apos;Steve&apos;, &apos;Jeff&apos;, &apos;Ryan&apos;]</span><br><span class="line">In [43]: obj</span><br><span class="line">Out[43]:</span><br><span class="line">Bob 4</span><br><span class="line">Steve 7</span><br><span class="line">Jeff -5</span><br><span class="line">Ryan 3</span><br><span class="line">dtype: int64</span><br><span class="line">DataFrame</span><br><span class="line">DataFrame是⼀个表格型的数据结构，它含有⼀组有序的列，每列可以是不同的值类型（数</span><br><span class="line">值、字符串、布尔值等），DataFrame既有⾏索引也有列索引。</span><br><span class="line">建DataFrame, 传⼊⼀个由等⻓列表或NumPy数组组成的字典</span><br><span class="line">data = &#123;&apos;state&apos;: [&apos;Ohio&apos;, &apos;Ohio&apos;, &apos;Ohio&apos;, &apos;Nevada&apos;, &apos;Nevada&apos;, &apos;Nevada&apos;],</span><br><span class="line"> &apos;year&apos;: [2000, 2001, 2002, 2001, 2002, 2003],</span><br><span class="line"> &apos;pop&apos;: [1.5, 1.7, 3.6, 2.4, 2.9, 3.2]&#125;</span><br><span class="line">frame = pd.DataFrame(data)</span><br><span class="line">特别⼤的DataFrame，head⽅法会选取前五⾏</span><br><span class="line">In [46]: frame.head()</span><br><span class="line">Out[46]:</span><br><span class="line"> pop state year</span><br><span class="line">0 1.5 Ohio 2000</span><br><span class="line">1 1.7 Ohio 2001</span><br><span class="line">2 3.6 Ohio 2002</span><br><span class="line">3 2.4 Nevada 2001</span><br><span class="line">4 2.9 Nevada 2002</span><br><span class="line">如果指定了列序列，则DataFrame的列就会按照指定顺序进⾏排列</span><br><span class="line">In [47]: pd.DataFrame(data, columns=[&apos;year&apos;, &apos;state&apos;, &apos;pop&apos;])</span><br><span class="line">Out[47]:</span><br><span class="line"> year state pop</span><br><span class="line">0 2000 Ohio 1.5</span><br><span class="line">1 2001 Ohio 1.7</span><br><span class="line">2 2002 Ohio 3.6</span><br><span class="line">3 2001 Nevada 2.4</span><br><span class="line">4 2002 Nevada 2.9</span><br><span class="line">5 2003 Nevada 3.2</span><br><span class="line">In [48]: frame2 = pd.DataFrame(data, columns=[&apos;year&apos;, &apos;state&apos;, &apos;pop&apos;, &apos;debt&apos;],</span><br><span class="line"> ....: index=[&apos;one&apos;, &apos;two&apos;, &apos;three&apos;, &apos;four&apos;,</span><br><span class="line"> ....: &apos;five&apos;, &apos;six&apos;])</span><br><span class="line">In [49]: frame2</span><br><span class="line">Out[49]:</span><br><span class="line"> year state pop debt</span><br><span class="line">one 2000 Ohio 1.5 NaN</span><br><span class="line">two 2001 Ohio 1.7 NaN</span><br><span class="line">three 2002 Ohio 3.6 NaN</span><br><span class="line">four 2001 Nevada 2.4 NaN</span><br><span class="line">five 2002 Nevada 2.9 NaN</span><br><span class="line">six 2003 Nevada 3.2 NaN</span><br><span class="line">In [50]: frame2.columns</span><br><span class="line">Out[50]: Index([&apos;year&apos;, &apos;state&apos;, &apos;pop&apos;, &apos;debt&apos;], dtype=&apos;object&apos;)</span><br><span class="line">将DataFrame的列获取为⼀个Series</span><br><span class="line">In [51]: frame2[&apos;state&apos;]</span><br><span class="line">Out[51]: </span><br><span class="line">one Ohio</span><br><span class="line">two Ohio</span><br><span class="line">three Ohio</span><br><span class="line">four Nevada</span><br><span class="line">five Nevada</span><br><span class="line">six Nevada</span><br><span class="line">Name: state, dtype: object</span><br><span class="line">In [52]: frame2.year</span><br><span class="line">Out[52]:</span><br><span class="line">one 2000</span><br><span class="line">two 2001</span><br><span class="line">three 2002</span><br><span class="line">four 2001</span><br><span class="line">five 2002</span><br><span class="line">six 2003</span><br><span class="line">Name: year, dtype: int64</span><br><span class="line">⾏也可以通过位置或名称的⽅式进⾏获取</span><br><span class="line">In [53]: frame2.loc[&apos;three&apos;]</span><br><span class="line">Out[53]:</span><br><span class="line">year 2002</span><br><span class="line">state Ohio</span><br><span class="line">pop 3.6</span><br><span class="line">debt NaN</span><br><span class="line">Name: three, dtype: object</span><br><span class="line">以给那个空的”debt”列赋上⼀个标量值或⼀组值</span><br><span class="line">In [54]: frame2[&apos;debt&apos;] = 16.5</span><br><span class="line">In [55]: frame2</span><br><span class="line">Out[55]:</span><br><span class="line"> year state pop debt</span><br><span class="line">one 2000 Ohio 1.5 16.5</span><br><span class="line">two 2001 Ohio 1.7 16.5</span><br><span class="line">three 2002 Ohio 3.6 16.5</span><br><span class="line">four 2001 Nevada 2.4 16.5</span><br><span class="line">five 2002 Nevada 2.9 16.5</span><br><span class="line">six 2003 Nevada 3.2 16.5</span><br><span class="line">In [56]: frame2[&apos;debt&apos;] = np.arange(6.)</span><br><span class="line">In [57]: frame2</span><br><span class="line">Out[57]:</span><br><span class="line"> year state pop debt</span><br><span class="line">one 2000 Ohio 1.5 0.0</span><br><span class="line">two 2001 Ohio 1.7 1.0</span><br><span class="line">three 2002 Ohio 3.6 2.0</span><br><span class="line">four 2001 Nevada 2.4 3.0</span><br><span class="line">five 2002 Nevada 2.9 4.0</span><br><span class="line">six 2003 Nevada 3.2 5.0</span><br><span class="line">如果赋值的是⼀个Series，就会精确匹配DataFrame的索引，所有的空位都将被填上缺失值</span><br><span class="line">In [58]: val = pd.Series([-1.2, -1.5, -1.7], index=[&apos;two&apos;, &apos;four&apos;, &apos;five&apos;])</span><br><span class="line">In [59]: frame2[&apos;debt&apos;] = val</span><br><span class="line">In [60]: frame2</span><br><span class="line">Out[60]:</span><br><span class="line"> year state pop debt</span><br><span class="line">one 2000 Ohio 1.5 NaN</span><br><span class="line">two 2001 Ohio 1.7 -1.2</span><br><span class="line">three 2002 Ohio 3.6 NaN</span><br><span class="line">four 2001 Nevada 2.4 -1.5</span><br><span class="line">five 2002 Nevada 2.9 -1.7</span><br><span class="line">six 2003 Nevada 3.2 NaN</span><br><span class="line">为不存在的列赋值会创建出⼀个新列。关键字del⽤于删除列。</span><br><span class="line">In [61]: frame2[&apos;eastern&apos;] = frame2.state == &apos;Ohio&apos;</span><br><span class="line">In [62]: frame2</span><br><span class="line">Out[62]:</span><br><span class="line"> year state pop debt eastern</span><br><span class="line">one 2000 Ohio 1.5 NaN True</span><br><span class="line">two 2001 Ohio 1.7 -1.2 True</span><br><span class="line">three 2002 Ohio 3.6 NaN True</span><br><span class="line">four 2001 Nevada 2.4 -1.5 False</span><br><span class="line">five 2002 Nevada 2.9 -1.7 False</span><br><span class="line">six 2003 Nevada 3.2 NaN False</span><br><span class="line"># 删除列</span><br><span class="line">del frame2[&apos;eastern&apos;]</span><br><span class="line">如果嵌套字典传给DataFrame，pandas就会被解释为：外层字典的键作为列，内层键则作为</span><br><span class="line">⾏索引</span><br><span class="line">In [65]: pop = &#123;&apos;Nevada&apos;: &#123;2001: 2.4, 2002: 2.9&#125;,</span><br><span class="line">....: &apos;Ohio&apos;: &#123;2000: 1.5, 2001: 1.7, 2002: 3.6&#125;&#125;</span><br><span class="line">In [66]: frame3 = pd.DataFrame(pop)</span><br><span class="line">In [67]: frame3</span><br><span class="line">Out[67]:</span><br><span class="line"> Nevada Ohio</span><br><span class="line">2000 NaN 1.5</span><br><span class="line">2001 2.4 1.7</span><br><span class="line">2002 2.9 3.6</span><br><span class="line">对DataFrame进⾏转置（交换⾏和列）</span><br><span class="line">In [68]: frame3.T</span><br><span class="line">Out[68]:</span><br><span class="line"> 2000 2001 2002</span><br><span class="line">Nevada NaN 2.4 2.9</span><br><span class="line">Ohio 1.5 1.7 3.6</span><br><span class="line">设置了DataFrame的index和columns的name属性，则这些信息也会被显示出来</span><br><span class="line">In [72]: frame3.index.name = &apos;year&apos;; frame3.columns.name = &apos;state&apos;</span><br><span class="line">In [73]: frame3</span><br><span class="line">Out[73]:</span><br><span class="line">state Nevada Ohio</span><br><span class="line">year</span><br><span class="line">2000 NaN 1.5</span><br><span class="line">2001 2.4 1.7</span><br><span class="line">2002 2.9 3.6</span><br><span class="line">values属性也会以⼆维ndarray的形式返回DataFrame中的数据</span><br><span class="line">In [74]: frame3.values</span><br><span class="line">Out[74]:</span><br><span class="line">array([[ nan, 1.5],</span><br><span class="line"> [ 2.4, 1.7],</span><br><span class="line"> [ 2.9, 3.6]])</span><br><span class="line">如果DataFrame各列的数据类型不同，则值数组的dtype就会选⽤能兼容所有列的数据类型：</span><br><span class="line">In [75]: frame2.values</span><br><span class="line">Out[75]:</span><br><span class="line">array([[2000, &apos;Ohio&apos;, 1.5, nan],</span><br><span class="line"> [2001, &apos;Ohio&apos;, 1.7, -1.2],</span><br><span class="line"> [2002, &apos;Ohio&apos;, 3.6, nan],</span><br><span class="line"> [2001, &apos;Nevada&apos;, 2.4, -1.5],</span><br><span class="line"> [2002, &apos;Nevada&apos;, 2.9, -1.7],</span><br><span class="line"> [2003, &apos;Nevada&apos;, 3.2, nan]], dtype=object)</span><br><span class="line">索引对象</span><br><span class="line">In [76]: obj = pd.Series(range(3), index=[&apos;a&apos;, &apos;b&apos;, &apos;c&apos;])</span><br><span class="line">In [77]: index = obj.index</span><br><span class="line">In [78]: index</span><br><span class="line">Out[78]: Index([&apos;a&apos;, &apos;b&apos;, &apos;c&apos;], dtype=&apos;object&apos;)</span><br><span class="line">In [79]: index[1:]</span><br><span class="line">Out[79]: Index([&apos;b&apos;, &apos;c&apos;], dtype=&apos;object&apos;)</span><br><span class="line">Index对象是不可变的，因此⽤户不能对其进⾏修改</span><br><span class="line">index[1] = ‘d’ # TypeError</span><br><span class="line">不可变可以使Index对象在多个数据结构之间安全共享</span><br><span class="line">In [80]: labels = pd.Index(np.arange(3))</span><br><span class="line">In [81]: labels</span><br><span class="line">Out[81]: Int64Index([0, 1, 2], dtype=&apos;int64&apos;)</span><br><span class="line">In [82]: obj2 = pd.Series([1.5, -2.5, 0], index=labels)</span><br><span class="line">In [83]: obj2</span><br><span class="line">Out[83]:</span><br><span class="line">0 1.5</span><br><span class="line">1 -2.5</span><br><span class="line">2 0.0</span><br><span class="line">dtype: float64</span><br><span class="line">In [84]: obj2.index is labels</span><br><span class="line">Out[84]: True</span><br><span class="line">基本功能</span><br><span class="line">pandas对象的⼀个重要⽅法是reindex，其作⽤是创建⼀个新对象，它的数据符合新的索引。</span><br><span class="line">In [91]: obj = pd.Series([4.5, 7.2, -5.3, 3.6], index=[&apos;d&apos;, &apos;b&apos;, &apos;a&apos;, &apos;c&apos;])</span><br><span class="line">In [92]: obj</span><br><span class="line">Out[92]:</span><br><span class="line">d 4.5</span><br><span class="line">b 7.2</span><br><span class="line">a -5.3</span><br><span class="line">c 3.6</span><br><span class="line">dtype: float64</span><br><span class="line">In [93]: obj2 = obj.reindex([&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;])</span><br><span class="line">In [94]: obj2</span><br><span class="line">Out[94]:</span><br><span class="line">a -5.3</span><br><span class="line">b 7.2</span><br><span class="line">c 3.6</span><br><span class="line">d 4.5</span><br><span class="line">e NaN</span><br><span class="line">dtype: float64</span><br><span class="line">时间序列这样的有序数据，重新索引时可能需要做⼀些插值处理。method选项即可达到此⽬</span><br><span class="line">的，例如，使⽤ffill可以实现前向值填充</span><br><span class="line">In [95]: obj3 = pd.Series([&apos;blue&apos;, &apos;purple&apos;, &apos;yellow&apos;], index=[0, 2, 4])</span><br><span class="line">In [96]: obj3</span><br><span class="line">Out[96]:</span><br><span class="line">0 blue</span><br><span class="line">2 purple</span><br><span class="line">4 yellow</span><br><span class="line">dtype: object</span><br><span class="line">In [97]: obj3.reindex(range(6), method=&apos;ffill&apos;)</span><br><span class="line">Out[97]: </span><br><span class="line">0 blue</span><br><span class="line">1 blue</span><br><span class="line">2 purple</span><br><span class="line">3 purple</span><br><span class="line">4 yellow</span><br><span class="line">5 yellow</span><br><span class="line">dtype: object</span><br><span class="line">reindex可以修改（⾏）索引和列。只传递⼀个序列时，会重新索引结果的⾏</span><br><span class="line">In [98]: frame = pd.DataFrame(np.arange(9).reshape((3, 3)),</span><br><span class="line"> ....: index=[&apos;a&apos;, &apos;c&apos;, &apos;d&apos;],</span><br><span class="line"> ....: columns=[&apos;Ohio&apos;, &apos;Texas&apos;, &apos;California&apos;])</span><br><span class="line">In [99]: frame</span><br><span class="line">Out[99]:</span><br><span class="line"> Ohio Texas California</span><br><span class="line">a 0 1 2</span><br><span class="line">c 3 4 5</span><br><span class="line">d 6 7 8</span><br><span class="line">In [100]: frame2 = frame.reindex([&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;])</span><br><span class="line">In [101]: frame2</span><br><span class="line">Out[101]:</span><br><span class="line"> Ohio Texas California</span><br><span class="line">a 0.0 1.0 2.0</span><br><span class="line">b NaN NaN NaN</span><br><span class="line">c 3.0 4.0 5.0</span><br><span class="line">d 6.0 7.0 8.0</span><br><span class="line">列可以⽤columns关键字重新索引</span><br><span class="line">In [102]: states = [&apos;Texas&apos;, &apos;Utah&apos;, &apos;California&apos;]</span><br><span class="line">In [103]: frame.reindex(columns=states)</span><br><span class="line">Out[103]: </span><br><span class="line"> Texas Utah California</span><br><span class="line">a 1 NaN 2</span><br><span class="line">c 4 NaN 5</span><br><span class="line">d 7 NaN 8</span><br><span class="line">丢弃指定轴上的项</span><br><span class="line">drop⽅法返回的是⼀个在指定轴上删除了指定值的新对象</span><br><span class="line">In [105]: obj = pd.Series(np.arange(5.), index=[&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;])</span><br><span class="line">In [106]: obj</span><br><span class="line">Out[106]:</span><br><span class="line">a 0.0</span><br><span class="line">b 1.0</span><br><span class="line">c 2.0</span><br><span class="line">d 3.0</span><br><span class="line">e 4.0</span><br><span class="line">dtype: float64</span><br><span class="line">In [107]: new_obj = obj.drop(&apos;c&apos;)</span><br><span class="line">In [108]: new_obj</span><br><span class="line">Out[108]:</span><br><span class="line">a 0.0</span><br><span class="line">b 1.0</span><br><span class="line">d 3.0</span><br><span class="line">e 4.0</span><br><span class="line">dtype: float64</span><br><span class="line">In [109]: obj.drop([&apos;d&apos;, &apos;c&apos;])</span><br><span class="line">Out[109]:</span><br><span class="line">a 0.0</span><br><span class="line">b 1.0</span><br><span class="line">e 4.0</span><br><span class="line">dtype: float64</span><br><span class="line">对于DataFrame，可以删除任意轴上的索引值</span><br><span class="line">In [110]: data = pd.DataFrame(np.arange(16).reshape((4, 4)),</span><br><span class="line"> .....: index=[&apos;Ohio&apos;, &apos;Colorado&apos;, &apos;Utah&apos;, &apos;New York&apos;],</span><br><span class="line"> .....: columns=[&apos;one&apos;, &apos;two&apos;, &apos;three&apos;, &apos;four&apos;])</span><br><span class="line">In [111]: data</span><br><span class="line">Out[111]:</span><br><span class="line"> one two three four</span><br><span class="line">Ohio 0 1 2 3</span><br><span class="line">Colorado 4 5 6 7</span><br><span class="line">Utah 8 9 10 11</span><br><span class="line">New York 12 13 14 15</span><br><span class="line">In [112]: data.drop([&apos;Colorado&apos;, &apos;Ohio&apos;])</span><br><span class="line">Out[112]:</span><br><span class="line"> one two three four</span><br><span class="line">Utah 8 9 10 11</span><br><span class="line">New York 12 13 14 15</span><br><span class="line">通过传递axis=1或axis=‘columns’可以删除列的值</span><br><span class="line">In [113]: data.drop(&apos;two&apos;, axis=1)</span><br><span class="line">Out[113]:</span><br><span class="line"> one three four</span><br><span class="line">Ohio 0 2 3</span><br><span class="line">Colorado 4 6 7</span><br><span class="line">Utah 8 10 11</span><br><span class="line">New York 12 14 15</span><br><span class="line">In [114]: data.drop([&apos;two&apos;, &apos;four&apos;], axis=&apos;columns&apos;)</span><br><span class="line">Out[114]:</span><br><span class="line"> one three</span><br><span class="line">Ohio 0 2</span><br><span class="line">Colorado 4 6</span><br><span class="line">Utah 8 10</span><br><span class="line">New York 12 14</span><br><span class="line">索引、选取和过滤</span><br><span class="line">In [117]: obj = pd.Series(np.arange(4.), index=[&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;])</span><br><span class="line">In [118]: obj</span><br><span class="line">Out[118]:</span><br><span class="line">a 0.0</span><br><span class="line">b 1.0</span><br><span class="line">c 2.0</span><br><span class="line">d 3.0</span><br><span class="line">dtype: float64</span><br><span class="line">In [119]: obj[&apos;b&apos;]</span><br><span class="line">Out[119]: 1.0</span><br><span class="line">In [120]: obj[1]</span><br><span class="line">Out[120]: 1.0</span><br><span class="line">In [121]: obj[2:4]</span><br><span class="line">Out[121]:</span><br><span class="line">c 2.0</span><br><span class="line">d 3.0</span><br><span class="line">dtype: float64</span><br><span class="line">In [122]: obj[[&apos;b&apos;, &apos;a&apos;, &apos;d&apos;]]</span><br><span class="line">Out[122]:</span><br><span class="line">b 1.0</span><br><span class="line">a 0.0</span><br><span class="line">d 3.0</span><br><span class="line">dtype: float64</span><br><span class="line">In [123]: obj[[1, 3]]</span><br><span class="line">Out[123]:</span><br><span class="line">b 1.0</span><br><span class="line">d 3.0</span><br><span class="line">dtype: float64</span><br><span class="line">In [124]: obj[obj &lt; 2]</span><br><span class="line">Out[124]:</span><br><span class="line">a 0.0</span><br><span class="line">b 1.0</span><br><span class="line">dtype: float64</span><br><span class="line">利⽤标签的切⽚运算与普通的Python切⽚运算不同，其末端是包含的</span><br><span class="line">In [125]: obj[&apos;b&apos;:&apos;c&apos;]</span><br><span class="line">Out[125]:</span><br><span class="line">b 1.0</span><br><span class="line">c 2.0</span><br><span class="line">dtype: float64</span><br><span class="line">In [126]: obj[&apos;b&apos;:&apos;c&apos;] = 5</span><br><span class="line">In [127]: obj</span><br><span class="line">Out[127]:</span><br><span class="line">a 0.0</span><br><span class="line">b 5.0</span><br><span class="line">c 5.0</span><br><span class="line">d 3.0</span><br><span class="line">dtype: float64</span><br><span class="line">⽤⼀个值或序列对DataFrame进⾏索引其实就是获取⼀个或多个列</span><br><span class="line">In [128]: data = pd.DataFrame(np.arange(16).reshape((4, 4)),</span><br><span class="line"> .....: index=[&apos;Ohio&apos;, &apos;Colorado&apos;, &apos;Utah&apos;, &apos;New York&apos;],</span><br><span class="line"> .....: columns=[&apos;one&apos;, &apos;two&apos;, &apos;three&apos;, &apos;four&apos;])</span><br><span class="line">In [129]: data</span><br><span class="line">Out[129]: </span><br><span class="line"> one two three four</span><br><span class="line">Ohio 0 1 2 3</span><br><span class="line">Colorado 4 5 6 7</span><br><span class="line">Utah 8 9 10 11</span><br><span class="line">New York 12 13 14 15</span><br><span class="line">In [130]: data[&apos;two&apos;]</span><br><span class="line">Out[130]:</span><br><span class="line">Ohio 1</span><br><span class="line">Colorado 5</span><br><span class="line">Utah 9</span><br><span class="line">New York 13</span><br><span class="line">Name: two, dtype: int64</span><br><span class="line">In [131]: data[[&apos;three&apos;, &apos;one&apos;]]</span><br><span class="line">Out[131]:</span><br><span class="line"> three one</span><br><span class="line">Ohio 2 0</span><br><span class="line">Colorado 6 4</span><br><span class="line">Utah 10 8</span><br><span class="line">New York 14 12</span><br><span class="line">In [132]: data[:2]</span><br><span class="line">Out[132]:</span><br><span class="line"> one two three four</span><br><span class="line">Ohio 0 1 2 3</span><br><span class="line">Colorado 4 5 6 7</span><br><span class="line">In [133]: data[data[&apos;three&apos;] &gt; 5]</span><br><span class="line">Out[133]:</span><br><span class="line"> one two three four</span><br><span class="line">Colorado 4 5 6 7</span><br><span class="line">Utah 8 9 10 11</span><br><span class="line">New York 12 13 14 15</span><br><span class="line">In [134]: data &lt; 5</span><br><span class="line">Out[134]:</span><br><span class="line"> one two three four</span><br><span class="line">Ohio True True True True</span><br><span class="line">Colorado True False False False</span><br><span class="line">Utah False False False False</span><br><span class="line">New York False False False False</span><br><span class="line">In [135]: data[data &lt; 5] = 0</span><br><span class="line">In [136]: data</span><br><span class="line">Out[136]:</span><br><span class="line"> one two three four</span><br><span class="line">Ohio 0 0 0 0</span><br><span class="line">Colorado 0 5 6 7</span><br><span class="line">Utah 8 9 10 11</span><br><span class="line">New York 12 13 14 15</span><br><span class="line">⽤loc和iloc进⾏选取</span><br><span class="line">使⽤轴标签（loc）或整数索引（iloc），从DataFrame选择⾏和列的⼦集。</span><br><span class="line">In [137]: data.loc[&apos;Colorado&apos;, [&apos;two&apos;, &apos;three&apos;]]</span><br><span class="line">Out[137]:</span><br><span class="line">two 5</span><br><span class="line">three 6</span><br><span class="line">Name: Colorado, dtype: int64</span><br><span class="line">⽤iloc和整数进⾏选取</span><br><span class="line">In [138]: data.iloc[2, [3, 0, 1]]</span><br><span class="line">Out[138]:</span><br><span class="line">four 11</span><br><span class="line">one 8</span><br><span class="line">two 9</span><br><span class="line">Name: Utah, dtype: int64</span><br><span class="line">In [139]: data.iloc[2]</span><br><span class="line">Out[139]:</span><br><span class="line">one 8</span><br><span class="line">two 9</span><br><span class="line">three 10</span><br><span class="line">four 11</span><br><span class="line">Name: Utah, dtype: int64</span><br><span class="line">In [140]: data.iloc[[1, 2], [3, 0, 1]]</span><br><span class="line">Out[140]:</span><br><span class="line"> four one two</span><br><span class="line">Colorado 7 0 5</span><br><span class="line">Utah 11 8 9</span><br><span class="line">In [141]: data.loc[:&apos;Utah&apos;, &apos;two&apos;]</span><br><span class="line">Out[141]:</span><br><span class="line">Ohio 0</span><br><span class="line">Colorado 5</span><br><span class="line">Utah 9</span><br><span class="line">Name: two, dtype: int64</span><br><span class="line">In [142]: data.iloc[:, :3][data.three &gt; 5]</span><br><span class="line">Out[142]:</span><br><span class="line"> one two three</span><br><span class="line">Colorado 0 5 6</span><br><span class="line">Utah 8 9 10</span><br><span class="line">New York 12 13 14</span><br><span class="line">算术运算和数据对⻬</span><br><span class="line">可以对不同索引的对象进⾏算术运算</span><br><span class="line">In [150]: s1 = pd.Series([7.3, -2.5, 3.4, 1.5], index=[&apos;a&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;])</span><br><span class="line">In [151]: s2 = pd.Series([-2.1, 3.6, -1.5, 4, 3.1],</span><br><span class="line"> .....: index=[&apos;a&apos;, &apos;c&apos;, &apos;e&apos;, &apos;f&apos;, &apos;g&apos;])</span><br><span class="line">In [152]: s1</span><br><span class="line">Out[152]:</span><br><span class="line">a 7.3</span><br><span class="line">c -2.5</span><br><span class="line">d 3.4</span><br><span class="line">e 1.5</span><br><span class="line">dtype: float64</span><br><span class="line">In [153]: s2</span><br><span class="line">Out[153]:</span><br><span class="line">a -2.1</span><br><span class="line">c 3.6</span><br><span class="line">e -1.5</span><br><span class="line">f 4.0</span><br><span class="line">g 3.1</span><br><span class="line">dtype: float64</span><br><span class="line">In [154]: s1 + s2</span><br><span class="line">Out[154]:</span><br><span class="line">a 5.2</span><br><span class="line">c 1.1</span><br><span class="line">d NaN</span><br><span class="line">e 0.0</span><br><span class="line">f NaN</span><br><span class="line">g NaN</span><br><span class="line">dtype: float64</span><br><span class="line">对于DataFrame，对⻬操作会同时发⽣在⾏和列上</span><br><span class="line">In [155]: df1 = pd.DataFrame(np.arange(9.).reshape((3, 3)),</span><br><span class="line">columns=list(&apos;bcd&apos;),</span><br><span class="line"> .....: index=[&apos;Ohio&apos;, &apos;Texas&apos;, &apos;Colorado&apos;])</span><br><span class="line">In [156]: df2 = pd.DataFrame(np.arange(12.).reshape((4, 3)), </span><br><span class="line">columns=list(&apos;bde&apos;),</span><br><span class="line"> .....: index=[&apos;Utah&apos;, &apos;Ohio&apos;, &apos;Texas&apos;, &apos;Oregon&apos;])</span><br><span class="line">In [157]: df1</span><br><span class="line">Out[157]:</span><br><span class="line"> b c d</span><br><span class="line">Ohio 0.0 1.0 2.0</span><br><span class="line">Texas 3.0 4.0 5.0</span><br><span class="line">Colorado 6.0 7.0 8.0</span><br><span class="line">In [158]: df2</span><br><span class="line">Out[158]:</span><br><span class="line"> b d e</span><br><span class="line">Utah 0.0 1.0 2.0</span><br><span class="line">Ohio 3.0 4.0 5.0</span><br><span class="line">Texas 6.0 7.0 8.0</span><br><span class="line">Oregon 9.0 10.0 11.0</span><br><span class="line">In [159]: df1 + df2</span><br><span class="line">Out[159]:</span><br><span class="line"> b c d e</span><br><span class="line">Colorado NaN NaN NaN NaN</span><br><span class="line">Ohio 3.0 NaN 6.0 NaN</span><br><span class="line">Oregon NaN NaN NaN NaN</span><br><span class="line">Texas 9.0 NaN 12.0 NaN</span><br><span class="line">Utah NaN NaN NaN NaN</span><br><span class="line">如果DataFrame对象相加，没有共⽤的列或⾏标签，结果都会是空</span><br><span class="line">In [160]: df1 = pd.DataFrame(&#123;&apos;A&apos;: [1, 2]&#125;)</span><br><span class="line">In [161]: df2 = pd.DataFrame(&#123;&apos;B&apos;: [3, 4]&#125;)</span><br><span class="line">In [162]: df1</span><br><span class="line">Out[162]:</span><br><span class="line"> A</span><br><span class="line">0 1</span><br><span class="line">1 2</span><br><span class="line">In [163]: df2</span><br><span class="line">Out[163]:</span><br><span class="line"> B</span><br><span class="line">0 3</span><br><span class="line">1 4</span><br><span class="line">In [164]: df1 - df2</span><br><span class="line">Out[164]:</span><br><span class="line"> A B</span><br><span class="line">0 NaN NaN</span><br><span class="line">1 NaN NaN</span><br><span class="line">在算术⽅法中填充值</span><br><span class="line">当⼀个对象中某个轴标签在另⼀个对象中找不到时填充⼀个特殊值（⽐如0）</span><br><span class="line">In [165]: df1 = pd.DataFrame(np.arange(12.).reshape((3, 4)),</span><br><span class="line"> .....: columns=list(&apos;abcd&apos;))</span><br><span class="line">In [166]: df2 = pd.DataFrame(np.arange(20.).reshape((4, 5)),</span><br><span class="line"> .....: columns=list(&apos;abcde&apos;))</span><br><span class="line">In [167]: df2.loc[1, &apos;b&apos;] = np.nan</span><br><span class="line">In [168]: df1</span><br><span class="line">Out[168]:</span><br><span class="line"> a b c d</span><br><span class="line">0 0.0 1.0 2.0 3.0</span><br><span class="line">1 4.0 5.0 6.0 7.0</span><br><span class="line">2 8.0 9.0 10.0 11.0</span><br><span class="line">In [169]: df2</span><br><span class="line">Out[169]:</span><br><span class="line"> a b c d e</span><br><span class="line">0 0.0 1.0 2.0 3.0 4.0</span><br><span class="line">1 5.0 NaN 7.0 8.0 9.0</span><br><span class="line">2 10.0 11.0 12.0 13.0 14.0</span><br><span class="line">3 15.0 16.0 17.0 18.0 19.0</span><br><span class="line">相加时，没有重叠的位置就会产⽣NA值</span><br><span class="line">In [170]: df1 + df2</span><br><span class="line">Out[170]:</span><br><span class="line"> a b c d e</span><br><span class="line">0 0.0 2.0 4.0 6.0 NaN</span><br><span class="line">1 9.0 NaN 13.0 15.0 NaN</span><br><span class="line">2 18.0 20.0 22.0 24.0 NaN</span><br><span class="line">3 NaN NaN NaN NaN NaN</span><br><span class="line">In [171]: df1.add(df2, fill_value=0)</span><br><span class="line">Out[171]:</span><br><span class="line"> a b c d e</span><br><span class="line">0 0.0 2.0 4.0 6.0 4.0</span><br><span class="line">1 9.0 5.0 13.0 15.0 9.0</span><br><span class="line">2 18.0 20.0 22.0 24.0 14.0</span><br><span class="line">3 15.0 16.0 17.0 18.0 19.0</span><br><span class="line">DataFrame和Series之间的运算</span><br><span class="line">In [179]: frame = pd.DataFrame(np.arange(12.).reshape((4, 3)),</span><br><span class="line"> .....: columns=list(&apos;bde&apos;),</span><br><span class="line"> .....: index=[&apos;Utah&apos;, &apos;Ohio&apos;, &apos;Texas&apos;, &apos;Oregon&apos;])</span><br><span class="line">In [180]: series = frame.iloc[0]</span><br><span class="line">In [181]: frame</span><br><span class="line">Out[181]:</span><br><span class="line"> b d e</span><br><span class="line">Utah 0.0 1.0 2.0</span><br><span class="line">Ohio 3.0 4.0 5.0</span><br><span class="line">Texas 6.0 7.0 8.0</span><br><span class="line">Oregon 9.0 10.0 11.0</span><br><span class="line">In [182]: series</span><br><span class="line">Out[182]:</span><br><span class="line">b 0.0</span><br><span class="line">d 1.0</span><br><span class="line">e 2.0</span><br><span class="line">Name: Utah, dtype: float64</span><br><span class="line">In [183]: frame - series</span><br><span class="line">Out[183]:</span><br><span class="line"> b d e</span><br><span class="line">Utah 0.0 0.0 0.0</span><br><span class="line">Ohio 3.0 3.0 3.0</span><br><span class="line">Texas 6.0 6.0 6.0</span><br><span class="line">Oregon 9.0 9.0 9.0</span><br><span class="line">如果某个索引值在DataFrame的列或Series的索引中找不到，则参与运算的两个对象就会被重</span><br><span class="line">新索引以形成并集</span><br><span class="line">In [184]: series2 = pd.Series(range(3), index=[&apos;b&apos;, &apos;e&apos;, &apos;f&apos;])</span><br><span class="line">In [185]: frame + series2</span><br><span class="line">Out[185]:</span><br><span class="line"> b d e f</span><br><span class="line">Utah 0.0 NaN 3.0 NaN</span><br><span class="line">Ohio 3.0 NaN 6.0 NaN</span><br><span class="line">Texas 6.0 NaN 9.0 NaN</span><br><span class="line">Oregon 9.0 NaN 12.0 NaN</span><br><span class="line">In [186]: series3 = frame[&apos;d&apos;]</span><br><span class="line">In [187]: frame</span><br><span class="line">Out[187]:</span><br><span class="line"> b d e</span><br><span class="line">Utah 0.0 1.0 2.0</span><br><span class="line">Ohio 3.0 4.0 5.0</span><br><span class="line">Texas 6.0 7.0 8.0</span><br><span class="line">Oregon 9.0 10.0 11.0</span><br><span class="line">In [188]: series3</span><br><span class="line">Out[188]:</span><br><span class="line">Utah 1.0</span><br><span class="line">Ohio 4.0</span><br><span class="line">Texas 7.0</span><br><span class="line">Oregon 10.0</span><br><span class="line">Name: d, dtype: float64</span><br><span class="line">In [189]: frame.sub(series3, axis=&apos;index&apos;)</span><br><span class="line">Out[189]:</span><br><span class="line"> b d e</span><br><span class="line">Utah -1.0 0.0 1.0</span><br><span class="line">Ohio -1.0 0.0 1.0</span><br><span class="line">Texas -1.0 0.0 1.0</span><br><span class="line">Oregon -1.0 0.0 1.0</span><br><span class="line">函数应⽤和映射</span><br><span class="line">In [190]: frame = pd.DataFrame(np.random.randn(4, 3), columns=list(&apos;bde&apos;),</span><br><span class="line"> .....: index=[&apos;Utah&apos;, &apos;Ohio&apos;, &apos;Texas&apos;, &apos;Oregon&apos;])</span><br><span class="line">In [191]: frame</span><br><span class="line">Out[191]:</span><br><span class="line"> b d e</span><br><span class="line">Utah -0.204708 0.478943 -0.519439</span><br><span class="line">Ohio -0.555730 1.965781 1.393406</span><br><span class="line">Texas 0.092908 0.281746 0.769023</span><br><span class="line">Oregon 1.246435 1.007189 -1.296221</span><br><span class="line">In [192]: np.abs(frame)</span><br><span class="line">Out[192]:</span><br><span class="line"> b d e</span><br><span class="line">Utah 0.204708 0.478943 0.519439</span><br><span class="line">Ohio 0.555730 1.965781 1.393406</span><br><span class="line">Texas 0.092908 0.281746 0.769023</span><br><span class="line">Oregon 1.246435 1.007189 1.296221</span><br><span class="line">应⽤到每列</span><br><span class="line">In [193]: f = lambda x: x.max() - x.min()</span><br><span class="line">In [194]: frame.apply(f)</span><br><span class="line">Out[194]:</span><br><span class="line">b 1.802165</span><br><span class="line">d 1.684034</span><br><span class="line">e 2.689627</span><br><span class="line">dtype: float64</span><br><span class="line">传递axis=‘columns’到apply，这个函数会在每⾏执⾏</span><br><span class="line">In [195]: frame.apply(f, axis=&apos;columns&apos;)</span><br><span class="line">Out[195]:</span><br><span class="line">Utah 0.998382</span><br><span class="line">Ohio 2.521511</span><br><span class="line">Texas 0.676115</span><br><span class="line">Oregon 2.542656</span><br><span class="line">dtype: float64</span><br><span class="line">In [196]: def f(x):</span><br><span class="line"> .....: return pd.Series([x.min(), x.max()], index=[&apos;min&apos;, &apos;max&apos;])</span><br><span class="line">In [197]: frame.apply(f)</span><br><span class="line">Out[197]: </span><br><span class="line"> b d e</span><br><span class="line">min -0.555730 0.281746 -1.296221</span><br><span class="line">max 1.246435 1.965781 1.393406</span><br><span class="line">得到frame中各个浮点值的格式化字符串，使⽤applymap即可</span><br><span class="line">In [198]: format = lambda x: &apos;%.2f&apos; % x</span><br><span class="line">In [199]: frame.applymap(format)</span><br><span class="line">Out[199]:</span><br><span class="line"> b d e</span><br><span class="line">Utah -0.20 0.48 -0.52</span><br><span class="line">Ohio -0.56 1.97 1.39</span><br><span class="line">Texas 0.09 0.28 0.77</span><br><span class="line">Oregon 1.25 1.01 -1.30</span><br><span class="line">Series有⼀个⽤于应⽤元素级函数的map⽅法</span><br><span class="line">In [200]: frame[&apos;e&apos;].map(format)</span><br><span class="line">Out[200]:</span><br><span class="line">Utah -0.52</span><br><span class="line">Ohio 1.39</span><br><span class="line">Texas 0.77</span><br><span class="line">Oregon -1.30</span><br><span class="line">Name: e, dtype: object</span><br><span class="line">排序和排名</span><br><span class="line">要对⾏或列索引进⾏排序（按字典顺序），可使⽤sort_index⽅法，它将返回⼀个已排序的新</span><br><span class="line">对象</span><br><span class="line">In [201]: obj = pd.Series(range(4), index=[&apos;d&apos;, &apos;a&apos;, &apos;b&apos;, &apos;c&apos;])</span><br><span class="line">In [202]: obj.sort_index()</span><br><span class="line">Out[202]:</span><br><span class="line">a 1</span><br><span class="line">b 2</span><br><span class="line">c 3</span><br><span class="line">d 0</span><br><span class="line">dtype: int64</span><br><span class="line">DataFrame，可以根据任意⼀个轴上的索引进⾏排序</span><br><span class="line">In [203]: frame = pd.DataFrame(np.arange(8).reshape((2, 4)),</span><br><span class="line"> .....: index=[&apos;three&apos;, &apos;one&apos;],</span><br><span class="line"> .....: columns=[&apos;d&apos;, &apos;a&apos;, &apos;b&apos;, &apos;c&apos;])</span><br><span class="line">In [445]: frame</span><br><span class="line">Out[445]:</span><br><span class="line"> d a b c</span><br><span class="line">three 0 1 2 3</span><br><span class="line">one 4 5 6 7</span><br><span class="line">In [204]: frame.sort_index()</span><br><span class="line">Out[204]:</span><br><span class="line"> d a b c</span><br><span class="line">one 4 5 6 7</span><br><span class="line">three 0 1 2 3</span><br><span class="line">In [205]: frame.sort_index(axis=1)</span><br><span class="line">Out[205]:</span><br><span class="line"> a b c d</span><br><span class="line">three 1 2 3 0</span><br><span class="line">one 5 6 7 4</span><br><span class="line">降序排序</span><br><span class="line">In [206]: frame.sort_index(axis=1, ascending=False)</span><br><span class="line">Out[206]:</span><br><span class="line"> d c b a</span><br><span class="line">three 0 3 2 1</span><br><span class="line">one 4 7 6 5</span><br><span class="line">按值对Series进⾏排序，可使⽤其sort_values⽅法</span><br><span class="line">In [207]: obj = pd.Series([4, 7, -3, 2])</span><br><span class="line">In [208]: obj.sort_values()</span><br><span class="line">Out[208]:</span><br><span class="line">2 -3</span><br><span class="line">3 2</span><br><span class="line">0 4</span><br><span class="line">1 7</span><br><span class="line">dtype: int64</span><br><span class="line">排序时，任何缺失值默认都会被放到Series的末尾</span><br><span class="line">In [209]: obj = pd.Series([4, np.nan, 7, np.nan, -3, 2])</span><br><span class="line">In [210]: obj.sort_values()</span><br><span class="line">Out[210]:</span><br><span class="line">4 -3.0</span><br><span class="line">5 2.0</span><br><span class="line">0 4.0</span><br><span class="line">2 7.0</span><br><span class="line">1 NaN</span><br><span class="line">3 NaN</span><br><span class="line">dtype: float64</span><br><span class="line">排序⼀个DataFrame时，根据⼀个或多个列中的值进⾏排序。将⼀个或多个列的名字传递给</span><br><span class="line">sort_values的by选项即可</span><br><span class="line">In [211]: frame = pd.DataFrame(&#123;&apos;b&apos;: [4, 7, -3, 2], &apos;a&apos;: [0, 1, 0, 1]&#125;)</span><br><span class="line">In [212]: frame</span><br><span class="line">Out[212]:</span><br><span class="line"> a b</span><br><span class="line">0 0 4</span><br><span class="line">1 1 7</span><br><span class="line">2 0 -3</span><br><span class="line">3 1 2</span><br><span class="line">In [213]: frame.sort_values(by=&apos;b&apos;)</span><br><span class="line">Out[213]:</span><br><span class="line"> a b</span><br><span class="line">2 0 -3</span><br><span class="line">3 1 2</span><br><span class="line">0 0 4</span><br><span class="line">1 1 7</span><br><span class="line">In [214]: frame.sort_values(by=[&apos;a&apos;, &apos;b&apos;])</span><br><span class="line">Out[214]:</span><br><span class="line"> a b</span><br><span class="line">2 0 -3</span><br><span class="line">0 0 4</span><br><span class="line">3 1 2</span><br><span class="line">1 1 7</span><br><span class="line">rank为各组分配⼀个平均排名</span><br><span class="line">In [215]: obj = pd.Series([7, -5, 7, 4, 2, 0, 4])</span><br><span class="line">In [216]: obj.rank()</span><br><span class="line">Out[216]:</span><br><span class="line">0 6.5</span><br><span class="line">1 1.0</span><br><span class="line">2 6.5</span><br><span class="line">3 4.5</span><br><span class="line">4 3.0</span><br><span class="line">5 2.0</span><br><span class="line">6 4.5</span><br><span class="line">dtype: float64</span><br><span class="line">根据值在原数据中出现的顺序给出排名</span><br><span class="line">In [217]: obj.rank(method=&apos;first&apos;)</span><br><span class="line">Out[217]:</span><br><span class="line">0 6.0</span><br><span class="line">1 1.0</span><br><span class="line">2 7.0</span><br><span class="line">3 4.0</span><br><span class="line">4 3.0</span><br><span class="line">5 2.0</span><br><span class="line">6 5.0</span><br><span class="line">dtype: float64</span><br><span class="line">也可以按降序进⾏排名</span><br><span class="line">In [217]: obj.rank(ascending=False, method=&apos;first&apos;)</span><br><span class="line">Out[217]:</span><br><span class="line">0 1.0</span><br><span class="line">1 7.0</span><br><span class="line">2 2.0</span><br><span class="line">3 3.0</span><br><span class="line">4 5.0</span><br><span class="line">5 6.0</span><br><span class="line">6 4.0</span><br><span class="line">dtype: float64</span><br><span class="line">DataFrame可以在⾏或列上计算排名</span><br><span class="line">In [219]: frame = pd.DataFrame(&#123;&apos;b&apos;: [4.3, 7, -3, 2], &apos;a&apos;: [0, 1, 0, 1],</span><br><span class="line"> .....: &apos;c&apos;: [-2, 5, 8, -2.5]&#125;)</span><br><span class="line">In [220]: frame</span><br><span class="line">Out[220]:</span><br><span class="line"> a b c</span><br><span class="line">0 0 4.3 -2.0</span><br><span class="line">1 1 7.0 5.0</span><br><span class="line">2 0 -3.0 8.0</span><br><span class="line">3 1 2.0 -2.5</span><br><span class="line">In [221]: frame.rank(axis=&apos;columns&apos;)</span><br><span class="line">Out[221]:</span><br><span class="line"> a b c</span><br><span class="line">0 2.0 3.0 1.0</span><br><span class="line">1 1.0 3.0 2.0</span><br><span class="line">2 2.0 1.0 3.0</span><br><span class="line">3 2.0 3.0 1.0</span><br><span class="line">带有重复标签的轴索引</span><br><span class="line">带有重复索引值的Series</span><br><span class="line">In [222]: obj = pd.Series(range(5), index=[&apos;a&apos;, &apos;a&apos;, &apos;b&apos;, &apos;b&apos;, &apos;c&apos;])</span><br><span class="line">In [223]: obj</span><br><span class="line">Out[223]:</span><br><span class="line">a 0</span><br><span class="line">a 1</span><br><span class="line">b 2</span><br><span class="line">b 3</span><br><span class="line">c 4</span><br><span class="line">dtype: int64</span><br><span class="line">In [224]: obj.index.is_unique</span><br><span class="line">Out[224]: False</span><br><span class="line">如果某个索引对应多个值，则返回⼀个Series；⽽对应单个值的，则返回⼀个标量值</span><br><span class="line">In [225]: obj[&apos;a&apos;]</span><br><span class="line">Out[225]:</span><br><span class="line">a 0</span><br><span class="line">a 1</span><br><span class="line">dtype: int64</span><br><span class="line">In [226]: obj[&apos;c&apos;]</span><br><span class="line">Out[226]: 4</span><br><span class="line">In [227]: df = pd.DataFrame(np.random.randn(4, 3), index=[&apos;a&apos;, &apos;a&apos;, &apos;b&apos;, &apos;b&apos;])</span><br><span class="line">In [228]: df</span><br><span class="line">Out[228]:</span><br><span class="line"> 0 1 2</span><br><span class="line">a 0.274992 0.228913 1.352917</span><br><span class="line">a 0.886429 -2.001637 -0.371843</span><br><span class="line">b 1.669025 -0.438570 -0.539741</span><br><span class="line">b 0.476985 3.248944 -1.021228</span><br><span class="line">In [229]: df.loc[&apos;b&apos;]</span><br><span class="line">Out[229]:</span><br><span class="line"> 0 1 2</span><br><span class="line">b 1.669025 -0.438570 -0.539741</span><br><span class="line">b 0.476985 3.248944 -1.021228</span><br><span class="line">汇总和计算描述统计</span><br><span class="line">pandas对象拥有⼀组常⽤的数学和统计⽅法。它们⼤部分都属于约简和汇总统计，⽤于从</span><br><span class="line">Series中提取单个值（如sum或mean）或从DataFrame的⾏或列中提取⼀个Series。</span><br><span class="line">In [230]: df = pd.DataFrame([[1.4, np.nan], [7.1, -4.5],</span><br><span class="line"> .....: [np.nan, np.nan], [0.75, -1.3]],</span><br><span class="line"> .....: index=[&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;],</span><br><span class="line"> .....: columns=[&apos;one&apos;, &apos;two&apos;])</span><br><span class="line">In [231]: df</span><br><span class="line">Out[231]:</span><br><span class="line"> one two</span><br><span class="line">a 1.40 NaN</span><br><span class="line">b 7.10 -4.5</span><br><span class="line">c NaN NaN</span><br><span class="line">d 0.75 -1.3</span><br><span class="line">调⽤DataFrame的sum⽅法将会返回⼀个含有列的和的Series</span><br><span class="line">In [232]: df.sum()</span><br><span class="line">Out[232]:</span><br><span class="line">one 9.25</span><br><span class="line">two -5.80</span><br><span class="line">dtype: float64</span><br><span class="line">传⼊axis=‘columns’或axis=1将会按⾏进⾏求和运算</span><br><span class="line">In [233]: df.sum(axis=1)</span><br><span class="line">Out[233]:</span><br><span class="line">a 1.40</span><br><span class="line">b 2.60</span><br><span class="line">c NaN</span><br><span class="line">d -0.55</span><br><span class="line">NA值会⾃动被排除，除⾮整个切⽚（这⾥指的是⾏或列）都是NA。通过skipna选项可以禁⽤</span><br><span class="line">该功能：</span><br><span class="line">In [234]: df.mean(axis=&apos;columns&apos;, skipna=False)</span><br><span class="line">Out[234]:</span><br><span class="line">a NaN</span><br><span class="line">b 1.300</span><br><span class="line">c NaN</span><br><span class="line">d -0.275</span><br><span class="line">dtype: float64</span><br><span class="line">唯⼀值、值计数以及成员资格</span><br><span class="line">unique，它可以得到Series中的唯⼀值数组</span><br><span class="line">In [251]: obj = pd.Series([&apos;c&apos;, &apos;a&apos;, &apos;d&apos;, &apos;a&apos;, &apos;a&apos;, &apos;b&apos;, &apos;b&apos;, &apos;c&apos;, &apos;c&apos;])</span><br><span class="line">In [252]: uniques = obj.unique()</span><br><span class="line">In [253]: uniques</span><br><span class="line">Out[253]: array([&apos;c&apos;, &apos;a&apos;, &apos;d&apos;, &apos;b&apos;], dtype=object)</span><br><span class="line">value_counts⽤于计算⼀个Series中各值出现的频率</span><br><span class="line">In [254]: obj.value_counts()</span><br><span class="line">Out[254]:</span><br><span class="line">c 3</span><br><span class="line">a 3</span><br><span class="line">b 2</span><br><span class="line">d 1</span><br><span class="line">dtype: int64</span><br><span class="line">isin⽤于判断⽮量化集合的成员资格</span><br><span class="line">In [256]: obj</span><br><span class="line">Out[256]:</span><br><span class="line">0 c</span><br><span class="line">1 a</span><br><span class="line">2 d</span><br><span class="line">3 a</span><br><span class="line">4 a</span><br><span class="line">5 b</span><br><span class="line">6 b</span><br><span class="line">7 c</span><br><span class="line">8 c</span><br><span class="line">dtype: object</span><br><span class="line">In [257]: mask = obj.isin([&apos;b&apos;, &apos;c&apos;])</span><br><span class="line">In [258]: mask</span><br><span class="line">Out[258]:</span><br><span class="line">0 True</span><br><span class="line">1 False</span><br><span class="line">2 False</span><br><span class="line">3 False</span><br><span class="line">4 False</span><br><span class="line">5 True</span><br><span class="line">6 True</span><br><span class="line">7 True</span><br><span class="line">8 True</span><br><span class="line">dtype: bool</span><br><span class="line">In [259]: obj[mask]</span><br><span class="line">Out[259]:</span><br><span class="line">0 c</span><br><span class="line">5 b</span><br><span class="line">6 b</span><br><span class="line">7 c</span><br><span class="line">8 c</span><br><span class="line">dtype: object</span><br><span class="line">结果中的⾏标签是所有列的唯⼀值。后⾯的频率值是每个列中这些值的相应计数</span><br><span class="line">In [263]: data = pd.DataFrame(&#123;&apos;Qu1&apos;: [1, 3, 4, 3, 4],</span><br><span class="line"> .....: &apos;Qu2&apos;: [2, 3, 1, 2, 3],</span><br><span class="line"> .....: &apos;Qu3&apos;: [1, 5, 2, 4, 4]&#125;)</span><br><span class="line">In [264]: data</span><br><span class="line">Out[264]:</span><br><span class="line"> Qu1 Qu2 Qu3</span><br><span class="line">0 1 2 1</span><br><span class="line">1 3 3 5</span><br><span class="line">2 4 1 2</span><br><span class="line">3 3 2 4</span><br><span class="line">4 4 3 4</span><br><span class="line">In [265]: result = data.apply(pd.value_counts).fillna(0)</span><br><span class="line">In [266]: result</span><br><span class="line">Out[266]:</span><br><span class="line"> Qu1 Qu2 Qu3</span><br><span class="line">1 1.0 1.0 1.0</span><br><span class="line">2 0.0 2.0 1.0</span><br><span class="line">3 2.0 2.0 0.0</span><br><span class="line">4 2.0 0.0 2.0</span><br><span class="line">5 0.0 0.0 1.0</span><br></pre></td></tr></table></figure>

            </div>

            <!-- Post Comments -->
            

        </div>
        <!-- Copyright 版权 start -->
                <div id="copyright">
            <ul>
                <li>&copy;Powered By <a href="https://hexo.io/zh-cn/" style="border-bottom: none;">hexo</a></li>
                <li>Design: <a href="http://miccall.tech " style="border-bottom: none;">miccall</a></li>
            </ul>
            
                <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
			
        </div>
    </div>
</body>



 	
</html>
